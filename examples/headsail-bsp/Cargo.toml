[package]
name = "headsail-bsp"
version = "0.1.0"
edition = "2021"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[features]
hpc-rt = ["hpc", "rt"]
sysctrl-rt = [
    "sysctrl",
    "rt",
    "riscv-rt/single-hart",
    "riscv/critical-section-single-hart",
]
panic-apb-uart0 = ["sprint-apb-uart0"]
panic-sysctrl-uart = ["sysctrl-pac"]
sprint-apb-uart0 = []
hpc = ["dep:riscv-pac", "dep:riscv-peripheral"]
sysctrl = []
alloc = ["dep:good_memory_allocator", "hpc"]
sdram = []
vp = [
    # VP only supports printing over APB UART0 since uDMA is not implemented on it so we force it
    # here to avoid accidents.
    "sprint-apb-uart0",
]
asic = []
sysctrl-pac = ["dep:headsail-sysctrl-pac", "sysctrl", "pac"]
hpc-pac = ["dep:headsail-hpc-pac", "hpc", "pac"]

# These are generated by the above options, don't use directly
rt = ["dep:riscv-rt"]
pac = []

[dependencies]
ufmt = "0.2.0"
ufmt-write = "0.1.0"
riscv-rt = { version = "0.12.2", optional = true }
riscv = { version = "0.11.1" }
riscv-peripheral = { version = "0.1.0", optional = true }
riscv-pac = { version = "0.1.1", optional = true }
good_memory_allocator = { version = "0.1.7", optional = true }
bit_field = "0.10.2"
headsail-sysctrl-pac = { git = "https://github.com/soc-hub-fi/headsail-pac", version = "0.1.1", optional = true }
headsail-hpc-pac = { git = "https://github.com/soc-hub-fi/headsail-pac", version = "0.1.1", optional = true }

[[example]]
name = "panic"
path = "examples/panic.rs"
required-features = ["panic-apb-uart0", "rt"]

[[example]]
name = "uart0"
path = "examples/uart0.rs"
required-features = ["rt"]

[[example]]
name = "uart0_read"
path = "examples/uart0_read.rs"
required-features = ["alloc", "rt", "sdram"]

[[example]]
name = "sprintln"
path = "examples/sprintln.rs"
required-features = ["rt", "sprint-apb-uart0"]

[[example]]
name = "alloc"
path = "examples/alloc.rs"
required-features = ["alloc", "rt", "sdram"]

[[example]]
name = "timer0"
path = "examples/timer0.rs"
required-features = ["panic-apb-uart0", "rt"]

[[example]]
name = "interrupts"
path = "examples/interrupts.rs"
required-features = ["panic-apb-uart0", "hpc-rt"]

[profile.dev]
panic = "abort"

[profile.release]
panic = "abort"
